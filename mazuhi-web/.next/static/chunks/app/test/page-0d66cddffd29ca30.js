(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[928],{6060:function(e,t,s){Promise.resolve().then(s.bind(s,5065))},5065:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return TestConnectionPage}});var n=s(7437),a=s(4672);function TestConnectionPage(){let{testConnection:e,testing:t,result:s}=(0,a.V)(),{menuData:r,loading:l,error:d,refetch:c,lastUpdated:i,stats:o}=(0,a.w)();return(0,n.jsx)("div",{className:"min-h-screen bg-gray-50 p-8",children:(0,n.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-8",children:"\uD83E\uDDEA Google Sheets Connection Test"}),(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-8",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"1. Test Connection"}),(0,n.jsx)("button",{onClick:e,disabled:t,className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-medium disabled:opacity-50",children:t?"\uD83D\uDD04 Testing...":"\uD83D\uDD17 Test Connection"}),s&&(0,n.jsxs)("div",{className:"mt-4 p-4 rounded-lg ".concat(s.success?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"),children:[(0,n.jsx)("div",{className:"font-medium ".concat(s.success?"text-green-800":"text-red-800"),children:s.success?"✅ Success!":"❌ Failed"}),(0,n.jsx)("div",{className:"text-sm mt-1 ".concat(s.success?"text-green-600":"text-red-600"),children:s.message})]})]}),(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-8",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"2. Load Menu Data"}),(0,n.jsx)("div",{className:"flex gap-4 mb-4",children:(0,n.jsx)("button",{onClick:c,disabled:l,className:"bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-lg font-medium disabled:opacity-50",children:l?"\uD83D\uDD04 Loading...":"\uD83D\uDCCA Load Menu Data"})}),l&&(0,n.jsxs)("div",{className:"flex items-center gap-2 text-blue-600",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"}),(0,n.jsx)("span",{children:"Loading menu data..."})]}),d&&(0,n.jsxs)("div",{className:"bg-red-50 border border-red-200 p-4 rounded-lg",children:[(0,n.jsx)("div",{className:"font-medium text-red-800",children:"❌ Error"}),(0,n.jsx)("div",{className:"text-sm text-red-600 mt-1",children:d})]}),!l&&!d&&r.length>0&&(0,n.jsxs)("div",{className:"bg-green-50 border border-green-200 p-4 rounded-lg",children:[(0,n.jsx)("div",{className:"font-medium text-green-800",children:"✅ Menu Data Loaded Successfully!"}),(0,n.jsxs)("div",{className:"text-sm text-green-600 mt-2",children:[(0,n.jsxs)("div",{children:["\uD83D\uDCCA Categories: ",o.categories]}),(0,n.jsxs)("div",{children:["\uD83C\uDF7D️ Total Items: ",o.totalItems]}),(0,n.jsxs)("div",{children:["\uD83D\uDD52 Last Updated: ",i?new Date(i).toLocaleString():"N/A"]})]})]})]}),r.length>0&&(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"3. Menu Data Preview"}),(0,n.jsx)("div",{className:"space-y-4",children:r.map(e=>(0,n.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,n.jsxs)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:["\uD83D\uDCC2 ",e.nombre," (",e.items.length," items)"]}),(0,n.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:e.items.slice(0,6).map((e,t)=>(0,n.jsxs)("div",{className:"bg-gray-50 p-3 rounded border",children:[(0,n.jsx)("div",{className:"font-medium text-sm text-gray-900",children:e.nombre}),(0,n.jsx)("div",{className:"text-xs text-gray-600 mt-1 line-clamp-2",children:e.descripcion}),(0,n.jsxs)("div",{className:"text-sm font-medium text-green-600 mt-1",children:["$",e.precio]}),(0,n.jsxs)("div",{className:"flex gap-1 mt-2",children:[e.nuevo&&(0,n.jsx)("span",{className:"text-xs bg-green-100 text-green-800 px-2 py-1 rounded",children:"Nuevo"}),e.vegetariano&&(0,n.jsx)("span",{className:"text-xs bg-green-100 text-green-800 px-2 py-1 rounded",children:"\uD83C\uDF31"}),e.picante&&(0,n.jsx)("span",{className:"text-xs bg-red-100 text-red-800 px-2 py-1 rounded",children:"\uD83C\uDF36️"})]})]},t))}),e.items.length>6&&(0,n.jsxs)("div",{className:"text-sm text-gray-500 mt-2",children:["... and ",e.items.length-6," more items"]})]},e.id))})]}),(0,n.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-6 mt-8",children:[(0,n.jsx)("h3",{className:"text-lg font-medium text-yellow-800 mb-2",children:"\uD83D\uDCCB Instructions"}),(0,n.jsxs)("div",{className:"text-sm text-yellow-700 space-y-1",children:[(0,n.jsx)("div",{children:"1. First, test the connection to make sure credentials are working"}),(0,n.jsx)("div",{children:"2. Then load the menu data to see if it's reading from your spreadsheet"}),(0,n.jsx)("div",{children:"3. Check the preview to make sure your data is formatted correctly"}),(0,n.jsx)("div",{children:"4. If everything looks good, the menu page will work automatically!"})]})]})]})})}},4672:function(e,t,s){"use strict";s.d(t,{V:function(){return useConnectionTest},w:function(){return useMenuData}});var n=s(2265);function useMenuData(){let[e,t]=(0,n.useState)([]),[s,a]=(0,n.useState)(!0),[r,l]=(0,n.useState)(null),[d,c]=(0,n.useState)(null),[i,o]=(0,n.useState)({categories:0,totalItems:0}),u=(0,n.useRef)(null),fetchMenuData=async()=>{try{l(null),console.log("\uD83D\uDD04 Fetching menu data...");let n=await fetch("/api/menu",{method:"GET",headers:{"Content-Type":"application/json"},cache:"no-store"});if(!n.ok)throw Error("HTTP error! status: ".concat(n.status));let a=await n.json();if(a.success){var e,s;t(a.data),c(a.lastUpdated),o(a.stats||{categories:0,totalItems:0}),console.log("✅ Menu data loaded:",{categories:null===(e=a.stats)||void 0===e?void 0:e.categories,items:null===(s=a.stats)||void 0===s?void 0:s.totalItems,cached:a.cached,cacheAge:a.cacheAge})}else throw Error(a.message||"Failed to fetch menu data")}catch(t){let e=t instanceof Error?t.message:"Unknown error occurred";l(e),console.error("❌ Error fetching menu:",t)}finally{a(!1)}};return(0,n.useEffect)(()=>{console.log("\uD83D\uDCCC useMenuData mounted - fetching initial data"),fetchMenuData()},[]),(0,n.useEffect)(()=>(console.log("⏱️ Setting up polling interval (30s)"),u.current=setInterval(()=>{console.log("\uD83D\uDD14 Polling for menu updates..."),fetchMenuData()},3e4),()=>{u.current&&(clearInterval(u.current),console.log("⏹️ Cleared polling interval"))}),[]),{menuData:e,loading:s,error:r,refetch:fetchMenuData,lastUpdated:d,stats:i}}function useConnectionTest(){let[e,t]=(0,n.useState)(!1),[s,a]=(0,n.useState)(null),testConnection=async()=>{try{t(!0),a(null);let e=await fetch("/api/menu",{method:"POST",headers:{"Content-Type":"application/json"}}),s=await e.json();return a(s),s.success}catch(e){return a({success:!1,message:e instanceof Error?e.message:"Connection test failed"}),!1}finally{t(!1)}};return{testConnection,testing:e,result:s}}}},function(e){e.O(0,[597,358,744],function(){return e(e.s=6060)}),_N_E=e.O()}]);