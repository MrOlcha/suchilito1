(()=>{var e={};e.id=7716,e.ids=[7716],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},57310:e=>{"use strict";e.exports=require("url")},39067:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>n.a,__next_app__:()=>m,originalPathname:()=>x,pages:()=>d,routeModule:()=>u,tree:()=>c});var s=a(67096),r=a(16132),i=a(37284),n=a.n(i),l=a(32564),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);a.d(t,o);let c=["",{children:["rest",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,17805)),"/var/www/mazuhi-web/src/app/rest/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,93897)),"/var/www/mazuhi-web/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,9291,23)),"next/dist/client/components/not-found-error"]}],d=["/var/www/mazuhi-web/src/app/rest/page.tsx"],x="/rest/page",m={require:a,loadChunk:()=>Promise.resolve()},u=new s.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/rest/page",pathname:"/rest",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},21876:(e,t,a)=>{Promise.resolve().then(a.bind(a,43592))},43592:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>RestaurantPage});var s=a(30784),r=a(9885),i=a(52451),n=a.n(i),l=a(94571),o=a(30569),c=a(34635),d=a(13524),x=a(40990),m=a(66328),u=a(57048),h=a(6369);let p=[{id:"conChile",label:"Con Chile",default:!1},{id:"picosillo",label:"Picosillo",default:!1}];function RestaurantPage(){let[e,t]=(0,r.useState)([]),[a,i]=(0,r.useState)([]),[g,b]=(0,r.useState)(!0),[f,y]=(0,r.useState)(!1),[j,v]=(0,r.useState)(!1),[N,w]=(0,r.useState)(""),[C,_]=(0,r.useState)("1"),[k,P]=(0,r.useState)(!1),[q,E]=(0,r.useState)(null),[M,S]=(0,r.useState)({conChile:!1,picosillo:!1,notar:""});(0,r.useEffect)(()=>{let fetchMenu=async()=>{try{console.log("\uD83D\uDCE5 Cargando men\xfa desde /api/menu");let e=await fetch("/api/menu"),a=await e.json(),s=a.data||a.categories||[];s.length>0&&(t(s),w(s[0].nombre||s[0].name),console.log("✅ Men\xfa cargado"))}catch(e){console.error("❌ Error loading menu:",e)}finally{b(!1)}};fetchMenu()},[]);let addToCart=e=>{E(e),S({conChile:!1,picosillo:!1,notar:""})},updateQuantity=(e,t)=>{i(a=>a.map(a=>{if(a.id===e){let e=a.quantity+t;return e>0?{...a,quantity:e}:a}return a}).filter(e=>e.quantity>0))},removeFromCart=e=>{i(t=>t.filter(t=>t.id!==e))},$=a.reduce((e,t)=>e+t.item.precio*t.quantity,0),O=a.reduce((e,t)=>e+t.quantity,0),getOptionsDescription=e=>{let t=[];return e.conChile&&t.push("Con Chile"),e.picosillo&&t.push("Picosillo"),e.notar&&t.push(`Nota: ${e.notar}`),t.length>0?t.join(" • "):"Sin opciones"},sendOrder=async()=>{if(0===a.length){alert("Agrega productos al carrito");return}y(!0);try{let e=await fetch("/api/waiter-notification",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({cart:{items:a.map(e=>({menuItem:e.item,quantity:e.quantity,subtotal:e.item.precio*e.quantity,options:{complementos:[],soya:null,cubiertos:null},specialOptions:e.options})),total:$,itemCount:O},tableNumber:C,isParaLlevar:k,isWaiterOrder:!0})}),t=await e.json();t.success?(v(!0),i([]),_("1"),P(!1),setTimeout(()=>v(!1),3e3)):alert("Error al enviar: "+t.message)}catch(e){console.error("❌ Error al enviar pedido:",e),alert("Error de conexi\xf3n")}finally{y(!1)}};return g?s.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:s.jsx("div",{className:"animate-spin w-12 h-12 border-4 border-orange-500 border-t-transparent rounded-full"})}):(0,s.jsxs)("div",{className:"min-h-screen bg-gray-900 text-white flex flex-col lg:flex-row",children:[(0,s.jsxs)("div",{className:"flex-1 flex flex-col",children:[s.jsx("header",{className:"bg-gray-800 shadow-lg z-30",children:(0,s.jsxs)("div",{className:"px-4 py-4 space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[s.jsx(n(),{src:"/images/iconologo.svg",alt:"Logo",width:40,height:40}),(0,s.jsxs)("div",{children:[s.jsx("h1",{className:"font-bold text-lg",children:"Mazuhi"}),s.jsx("p",{className:"text-xs text-gray-400",children:"Modo Mesero"})]})]}),s.jsx("div",{className:"flex overflow-x-auto pb-2 gap-2 scrollbar-hide",children:e.map(e=>{let t=e.nombre||e.name||"";return s.jsx("button",{onClick:()=>w(t),className:`px-3 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-all ${N===t?"bg-orange-500 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:t.replace(/_/g," ")},t)})})]})}),s.jsx("main",{className:"flex-1 overflow-y-auto p-3 md:p-4",children:s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-3 gap-3",children:e.find(e=>(e.nombre||e.name)===N)?.items?.map((e,t)=>{let r=a.filter(t=>t.item.nombre===e.nombre).length;return s.jsxs(l.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.03*t},onClick:()=>addToCart(e),className:`bg-gray-800 rounded-xl overflow-hidden cursor-pointer transition-all hover:scale-105 hover:shadow-xl ${r>0?"ring-2 ring-orange-500":""}`,children:[s.jsxs("div",{className:"relative h-20 sm:h-24",children:[s.jsx(n(),{src:e.imagen_url||"/images/menu/placeholder.jpg",alt:e.nombre,fill:!0,className:"object-cover"}),r>0&&s.jsx("div",{className:"absolute top-1 right-1 bg-orange-500 text-white w-5 h-5 rounded-full flex items-center justify-center text-xs font-bold",children:r})]}),s.jsxs("div",{className:"p-2",children:[s.jsx("h3",{className:"font-medium text-xs sm:text-sm truncate",children:e.nombre}),s.jsxs("p",{className:"text-orange-400 font-bold text-xs sm:text-sm",children:["$",e.precio]})]})]},e.nombre+t)})})})]}),(0,s.jsxs)("div",{className:"w-full lg:w-80 bg-gray-800 border-l border-gray-700 flex flex-col",children:[(0,s.jsxs)("div",{className:"p-4 border-b border-gray-700 space-y-3",children:[(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Mesa"}),s.jsx("div",{className:"flex gap-2 flex-wrap",children:["1","2","3","4","5","6"].map(e=>s.jsx("button",{onClick:()=>_(e),className:`w-10 h-10 rounded-lg font-bold transition-all text-sm ${C===e?"bg-orange-500 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:e},e))})]}),(0,s.jsxs)("label",{className:"flex items-center gap-3 cursor-pointer p-3 bg-gray-700 rounded-lg hover:bg-gray-600 transition-all",children:[s.jsx("input",{type:"checkbox",checked:k,onChange:e=>P(e.target.checked),className:"w-5 h-5 cursor-pointer"}),s.jsx("span",{className:"font-medium text-sm",children:"Para llevar"})]})]}),s.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-2",children:0===a.length?s.jsx("div",{className:"flex items-center justify-center h-full text-gray-400 text-sm",children:s.jsx("p",{children:"Carrito vac\xedo"})}):a.map(e=>(0,s.jsxs)("div",{className:"bg-gray-700 rounded-lg p-2 text-xs",children:[(0,s.jsxs)("div",{className:"flex justify-between items-start mb-1",children:[s.jsx("p",{className:"font-medium truncate flex-1",children:e.item.nombre}),s.jsx("button",{onClick:()=>removeFromCart(e.id),className:"w-5 h-5 bg-red-600/20 text-red-400 rounded flex items-center justify-center hover:bg-red-600/40 flex-shrink-0",children:s.jsx(c.Z,{className:"w-3 h-3"})})]}),(e.options.conChile||e.options.picosillo||e.options.notar)&&s.jsx("p",{className:"text-gray-400 text-xs mb-1 truncate",children:getOptionsDescription(e.options)}),(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("span",{className:"text-orange-400 font-bold",children:["$",(e.item.precio*e.quantity).toFixed(2)]}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[s.jsx("button",{onClick:()=>updateQuantity(e.id,-1),className:"w-5 h-5 bg-gray-600 rounded flex items-center justify-center hover:bg-gray-500 text-xs",children:s.jsx(d.Z,{className:"w-2 h-2"})}),s.jsx("span",{className:"w-4 text-center text-xs font-medium",children:e.quantity}),s.jsx("button",{onClick:()=>updateQuantity(e.id,1),className:"w-5 h-5 bg-gray-600 rounded flex items-center justify-center hover:bg-gray-500 text-xs",children:s.jsx(x.Z,{className:"w-2 h-2"})})]})]})]},e.id))}),(0,s.jsxs)("div",{className:"border-t border-gray-700 p-4 space-y-3",children:[(0,s.jsxs)("div",{className:"bg-gray-700 rounded-lg p-3 text-sm space-y-1",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsxs)("span",{children:["Mesa: ",s.jsx("span",{className:"font-bold",children:C})]}),k&&s.jsx("span",{className:"text-orange-400 font-bold text-xs",children:"Para Llevar"})]}),(0,s.jsxs)("div",{className:"flex justify-between text-gray-300",children:[(0,s.jsxs)("span",{children:[O," producto",1!==O?"s":""]}),(0,s.jsxs)("span",{className:"text-orange-400 font-bold",children:["$",$.toFixed(2)]})]})]}),s.jsx("button",{onClick:sendOrder,disabled:f||0===a.length,className:"w-full flex items-center justify-center gap-2 bg-orange-500 hover:bg-orange-600 disabled:bg-gray-600 disabled:cursor-not-allowed text-white font-bold py-3 rounded-xl transition-all text-sm",children:f?(0,s.jsxs)(s.Fragment,{children:[s.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-white border-t-transparent rounded-full"}),"Enviando..."]}):(0,s.jsxs)(s.Fragment,{children:[s.jsx(m.Z,{className:"w-4 h-4"}),"Enviar"]})})]})]}),s.jsx(o.M,{children:q&&s.jsx(l.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:(0,s.jsxs)(l.E.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-gray-800 rounded-2xl max-w-sm w-full p-6 max-h-[90vh] overflow-y-auto",children:[(0,s.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,s.jsxs)("div",{children:[s.jsx("h2",{className:"text-2xl font-bold",children:q.nombre}),(0,s.jsxs)("p",{className:"text-orange-400 font-bold text-lg",children:["$",q.precio]})]}),s.jsx("button",{onClick:()=>E(null),className:"text-gray-400 hover:text-white flex-shrink-0",children:s.jsx(u.Z,{className:"w-6 h-6"})})]}),(0,s.jsxs)("div",{className:"space-y-3 mb-6",children:[s.jsx("h3",{className:"font-semibold text-gray-300",children:"Opciones Especiales"}),p.map(e=>(0,s.jsxs)("label",{className:"flex items-center gap-3 p-3 bg-gray-700 rounded-lg hover:bg-gray-600 cursor-pointer transition-all",children:[s.jsx("input",{type:"checkbox",checked:M[e.id]||!1,onChange:t=>S(a=>({...a,[e.id]:t.target.checked})),className:"w-5 h-5 cursor-pointer"}),s.jsx("span",{className:"font-medium",children:e.label})]},e.id))]}),(0,s.jsxs)("div",{className:"mb-6",children:[s.jsx("label",{className:"block text-sm font-semibold text-gray-300 mb-2",children:"Notas adicionales"}),s.jsx("textarea",{value:M.notar||"",onChange:e=>S(t=>({...t,notar:e.target.value})),className:"w-full bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-white placeholder-gray-500 focus:outline-none focus:border-orange-500 text-sm",placeholder:"Ej: Sin anguila, extra picante...",rows:3})]}),(0,s.jsxs)("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:()=>E(null),className:"flex-1 bg-gray-700 hover:bg-gray-600 text-white font-bold py-3 rounded-lg transition-all",children:"Cancelar"}),s.jsx("button",{onClick:()=>{if(!q)return;let e=`${q.nombre}-${Date.now()}-${Math.random()}`;i(t=>[...t,{id:e,item:q,quantity:1,options:{...M}}]),E(null)},className:"flex-1 bg-orange-500 hover:bg-orange-600 text-white font-bold py-3 rounded-lg transition-all",children:"Agregar"})]})]})})}),s.jsx(o.M,{children:j&&s.jsx(l.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50",children:(0,s.jsxs)(l.E.div,{initial:{scale:.5,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.5,opacity:0},className:"bg-gray-800 rounded-2xl p-8 text-center max-w-sm mx-4",children:[s.jsx(h.Z,{className:"w-20 h-20 text-green-500 mx-auto mb-4"}),s.jsx("h2",{className:"text-2xl font-bold mb-2",children:"\xa1Pedido Enviado!"}),s.jsx("p",{className:"text-gray-400 text-sm",children:"La notificaci\xf3n ha sido enviada a cocina"})]})})})]})}},17805:(e,t,a)=>{"use strict";a.r(t),a.d(t,{$$typeof:()=>n,__esModule:()=>i,default:()=>o});var s=a(95153);let r=(0,s.createProxy)(String.raw`/var/www/mazuhi-web/src/app/rest/page.tsx`),{__esModule:i,$$typeof:n}=r,l=r.default,o=l}};var t=require("../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),a=t.X(0,[7553,2430,8336],()=>__webpack_exec__(39067));module.exports=a})();